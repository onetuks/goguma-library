files:
  "/etc/nginx/conf.d/proxy.conf":
    mode: "000755"
    owner: root
    group: root
    content: |
      proxy_connect_timeout 190s;
      proxy_send_timeout 190s;
      proxy_read_timeout 190s;
      client_header_timeout 190s;
      client_body_timeout 190s;
      keepalive_timeout 190s;
      keepalive_requests 190;
      keepalive_disable none;

      log_format combined '$http_x_forwarded_for $remote_addr - $remote_user [$time_local] '
                          '"$request" $status $body_bytes_sent "$http_referer" '
                          '"$http_user_agent" $request_time';

      access_log /var/log/nginx/access.log combined;

container_commands:
  restart_nginx:
    command: "sudo service nginx reload"